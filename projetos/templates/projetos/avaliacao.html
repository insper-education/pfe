{% extends "base.html" %}
{% comment %}
    Desenvolvido para o Projeto Final de Engenharia
    Autor: Luciano Pereira Soares <lpsoares@insper.edu.br>
    Data: 10 de Abril de 2020
{% endcomment %}

{% block head %}
<script>
  {% comment %} Acho que isso veio por engano para cá {% endcomment %}
  $(document).ready(function () {     
    $('#projeto').change(function(){
      var titulo = $(this).children(':selected').data('titulo');
      var organizacao = $(this).children(':selected').data('organizacao');
      var orientador = $(this).children(':selected').data('orientador');
      $('#titulo').text(titulo);
      $('#organizacao').text(organizacao);
      $('#orientador').text(orientador);
    })
  });
</script>

<style>
  textarea {
    max-width:100%;
  }
</style>
{% endblock %}

{% block content %}
  {% if projeto %}
    <form method="post" id="avaliacaoform" enctype="multipart/form-data">
      {% csrf_token %}

      <b>Título do Projeto:</b> {{projeto.titulo}}<br>
      <b>Organização:</b> {{projeto.organizacao}}<br>
      <b>Orientador{% if projeto.orientador.user.genero == "F" %}a{% endif %}:</b> {{projeto.orientador}}<br>
      <b>Grupo:</b>
      <ul>
        {% for alocacao in banca.projeto.alocacao_set.all %}
          <li>
            {% comment %} <a href="{% url 'aluno_detail' alocacao.aluno.id %}">{% endcomment %} 
              {{alocacao.aluno.user.get_full_name}}
            {% comment %} </a>
            <a href="mailto:{{alocacao.aluno.user.email}}">&lt;{{alocacao.aluno.user.email}}&gt;</a>
            {% endcomment %} 
            [{{ alocacao.aluno.get_curso_display }}]
          </li>
        {% endfor %}
      </ul>

      <b>Banca:</b>
      {% if banca.tipo_de_banca == 0 %}Final{% else %}Intermediária{% endif %}
      {% comment %}
      <select name="tipo_banca" id="tipo_banca" required>
        <option value="final" {% if guess_banca == 0 %}selected{% endif %}>final</option>
        <option value="intermediaria" {% if guess_banca == 1 %}selected{% endif %}>intermediária</option>
      </select>
      {% endcomment %}
      <br>
      <b>Data:</b> {{banca.startDate|date:"DATE_FORMAT"}} das {{banca.startDate|date:"H:i"}} às {{banca.endDate|date:"H:i"}}<br>
      {% if banca.location %}
        <b>Local:</b> {{banca.location}}<br>
      {% endif %}  
      {% if banca.link %}
        <b>Link:</b> <a href="{{banca.link}}">{{banca.link}}</a>
        <br>
      {% endif %}
      
      <br><b><label for="avaliador">Avaliador(a)</label></b>:
      <select name="avaliador" id="avaliador" title="Selecione avaliador da banca" required>
          <option disabled selected value> -- selecione um avaliador -- </option>
          {% for professor in pessoas %}
            <option value="{{professor.id}}" {% if professor.id == banca.membro1.id %}selected{% endif %}>
              {{professor}}
            </option>  
          {% endfor %}
      </select><br>

      <br>
      <h5>Orientações Gerais</h5>

O professor(a) orientador(a) é responsável por conduzir a banca. Os membros do grupo terão <b>40 minutos para a apresentação</b>. Os membros da banca terão depois <b>50 minutos para arguição</b> (que serão divididos pelos membros convidados), podendo tirar qualquer dúvida a respeito do projeto e fazerem seus comentários. Caso haja muitas interferências da banca durante a apresentação do grupo, poderá se estender o tempo de apresentação. A dinâmica de apresentação é livre, contudo, <b>todos os alunos devem estar prontos para responder qualquer tipo de pergunta</b> sobre o projeto. Um membro da banca pode fazer uma pergunta direcionada para um aluno específico do grupo se desejar.
<br><br>
Como ordem recomendada para a arguição da banca, se deve convidar: professores convidados, professores coorientadores, professor(a) orientador(a) do projeto e por fim demais pessoas assistindo à apresentação. A banca poderá perguntar tanto sobre a apresentação, como o relatório entregue, se espera coletar informações tanto da apresentação, como do relatório, permitindo uma clara ponderação nas rubricas dos objetivos de aprendizado do Projeto Final de Engenharia.
<br><br>
As bancas do Projeto Final de Engenharia servem como mais um evidência de aprendizado, assim, além da percepção dos membros da banca em relação ao nível alcançado nos objetivos de aprendizado pelos membros do grupo, serve também como registro da evolução do projeto. Dessa forma, ao final, a banca terá mais <b>15 minutos para ponderar</b>, nesse momento se recomenda dispensar os estudantes e demais convidados externos. Recomendamos 5 minutos para os membros da banca relerem os objetivos de aprendizagem e rubricas, fazerem qualquer anotação e depois 10 minutos para uma discussão final. Cada membro da banca poderá colocar seu veredito sobre grupo, usando as rubricas a seguir. O professor(a) orientador(a) irá publicar (no Blackboard), ao final, a média dos conceitos anotados.
<br><br>
No Projeto Final de Engenharia, a maioria dos projetos está sob sigilo. Nos contratos realizados (quando pedido ou necessário) entre a Organização Parceira e o Insper, se tem os professores automaticamente responsáveis por garantir o sigilo das informações. Assim <b>pessoas externas só podem participar das bancas com prévia autorização</b>, isso inclui outros estudantes que não sejam do grupo, familiares ou amigos.
<br>

      <br><h5>Objetivos de Aprendizagem</h5>
      {% for objetivo in objetivos %}
        <b>{{objetivo.titulo}}</b>: {{objetivo.objetivo}}
        <table style="width:100%">
          <tr>
            <th style="width:18%"><input type="radio" id="objetivo.{{forloop.counter}}{{objetivo.id}}.I " name="objetivo.{{ forloop.counter }}" value="{{objetivo.id}}.I " required> <label for="objetivo.{{forloop.counter}}{{objetivo.id}}.I ">Insatisfatório (I)</label></th>
            <th style="width:18%"><input type="radio" id="objetivo.{{forloop.counter}}{{objetivo.id}}.D " name="objetivo.{{ forloop.counter }}" value="{{objetivo.id}}.D " required> <label for="objetivo.{{forloop.counter}}{{objetivo.id}}.D ">Em Desenvolvimento (D)</label></th>
            <th style="width:18%"><input type="radio" id="objetivo.{{forloop.counter}}{{objetivo.id}}.C " name="objetivo.{{ forloop.counter }}" value="{{objetivo.id}}.C " required> <label for="objetivo.{{forloop.counter}}{{objetivo.id}}.C ">Essencial (C)</label></th>
            <th style="width:18%"><input type="radio" id="objetivo.{{forloop.counter}}{{objetivo.id}}.B " name="objetivo.{{ forloop.counter }}" value="{{objetivo.id}}.B " required> <label for="objetivo.{{forloop.counter}}{{objetivo.id}}.B ">Proficiente (B)</label></th>
            <th style="width:18%"><input type="radio" id="objetivo.{{forloop.counter}}{{objetivo.id}}.A " name="objetivo.{{ forloop.counter }}" value="{{objetivo.id}}.A " required> <label for="objetivo.{{forloop.counter}}{{objetivo.id}}.A ">Avançado (A)</label></th>
            <th style="width:10%"><input type="radio" id="objetivo.{{forloop.counter}}{{objetivo.id}}.NA" name="objetivo.{{ forloop.counter }}" value="{{objetivo.id}}.NA" required> <label for="objetivo.{{forloop.counter}}{{objetivo.id}}.NA">N/A</label></th>
          </tr>
          <tr>
            <td><label for="objetivo.{{forloop.counter}}{{objetivo.id}}.I ">{{objetivo.rubrica_I}}</label></td>
            <td><label for="objetivo.{{forloop.counter}}{{objetivo.id}}.D ">{{objetivo.rubrica_D}}</label></td>
            <td><label for="objetivo.{{forloop.counter}}{{objetivo.id}}.C ">{{objetivo.rubrica_C}}</label></td>
            <td><label for="objetivo.{{forloop.counter}}{{objetivo.id}}.B ">{{objetivo.rubrica_B}}</label></td>
            <td><label for="objetivo.{{forloop.counter}}{{objetivo.id}}.A ">{{objetivo.rubrica_A}}</label></td>
            <td><label for="objetivo.{{forloop.counter}}{{objetivo.id}}.NA">caso prefira não avaliar este objetivo, selecione esta coluna.</label></td>
          </tr>
        </table><br>
      {% endfor %}
      
      <br><b>Observações:</b><br>
      <textarea name="observacoes" rows="8" cols="80" maxlength="2048"></textarea>
      
      <br><br>
      <button type="submit">Enviar Avaliação</button>
      <p>&nbsp;</p>
    </form>
  {% else %}
    <p>Não existe projeto disponível para avaliar.</p>
  {% endif %}
  <p>&nbsp;</p>

{% endblock %}