{% extends "base.html" %}
{% comment %}
    Desenvolvido para o Projeto Final de Engenharia
    Autor: Luciano Pereira Soares <lpsoares@insper.edu.br>
    Data: 22 de Setembro de 2020
{% endcomment %}

{% block head %}

  {% load static %}
  
  <script src="{% static 'js/w3.js' %}"></script>
  <script src="{% static 'js/Chart.min.js' %}"></script>
  <script src="{% static 'js/chartjs-plugin-datalabels.js' %}"></script>

  {% comment %} Para chamar os Tooltips {% endcomment %}
  <script>{% include "tooltip.js" %}</script>

{% endblock %}

{% block content %}
    <span class="titulo">Organizações, Projetos e Propostas</span>
    
    <div class="2areas2">

        <div id="canvas-holder">

            <canvas id="bar-projetos"></canvas>
            <br>

            <canvas id="bar-organizacoes"></canvas>
            <small>Dados de prospecção até 2019.2 estão incompletos.</small>
            <br><br>

        </div>

    </div>

    <script>
    
        var config_projetos = {
            type: 'bar',
            data: {
            labels: [
                {% for loop in loop_anos %}
                "{{loop}}.2",
                "{{loop|add:1}}.1",
                {% endfor %}
                ],
            datasets: [
                {
                label: "propostas",
                backgroundColor: "#5e8ea2",
                data: [
                        {% for num in num_propostas %}
                            {{num}},
                        {% endfor %}
                    ]
                }, 
                {
                label: "projetos",
                backgroundColor: "#353ecd",
                data: [
                        {% for num in num_projetos %}
                            {{num}},
                        {% endfor %}
                    ]
                }, 
            ]
            },
            options: {
                legend: { display: true },
                title: {
                    display: true,
                    text: 'Propostas e Projetos'
                }
            }
        };

        var config_organizacoes = {
            type: 'bar',
            data: {
            labels: [
                {% for loop in loop_anos %}
                "{{loop}}.2",
                "{{loop|add:1}}.1",
                {% endfor %}
                ],
            datasets: [
                {
                    label: "prospectadas (semestre anterior)",
                    backgroundColor: "#f9d5e5",
                    data: [
                            {% for num in org_prospectadas %}
                                {{num}},
                            {% endfor %}
                        ]
                }, 
                {
                    label: "com proposta",
                    backgroundColor: "#e06377",
                    data: [
                            {% for num in org_propostas %}
                                {{num}},
                            {% endfor %}
                        ]
                },
                {
                    label: "com projeto",
                    backgroundColor: "#c83349",
                    data: [
                            {% for num in org_projetos %}
                                {{num}},
                            {% endfor %}
                        ]
                },
            ]
            },
            options: {
                legend: { display: true },
                title: {
                    display: true,
                    text: 'Organizações Envolvidas'
                }
            }
        };


        function carrega_semestre() {  
            // Chart da quantidade de projetos
            var bar_projetos = document.getElementById('bar-projetos').getContext('2d');
            window.projeto = new Chart(bar_projetos, config_projetos);

            // Chart da quantidade de organizacoes
            var bar_organizacoes = document.getElementById('bar-organizacoes').getContext('2d');
            window.organizacoes = new Chart(bar_organizacoes, config_organizacoes);
        }

        window.onload = carrega_semestre
    
    </script>


{% endblock %}