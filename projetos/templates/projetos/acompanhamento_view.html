{% comment %}
    Desenvolvido para o Projeto Final de Engenharia
    Autor: Luciano Pereira Soares <lpsoares@insper.edu.br>
    Data: 7 de Abril de 2021
{% endcomment %}

{% load static %}
<link rel="stylesheet" href="{% static 'bootstrap-select-1.13.14/dist/css/bootstrap-select.min.css' %}">
<script src="{% static 'bootstrap-select-1.13.14/dist/js/bootstrap-select.min.js' %}"></script>

<style>
  {% comment %} Para seleção de projeto não vazar a tela {% endcomment %}
  .bootstrap-select > .dropdown-menu { 
    width: 100vw;
    max-width: fit-content;
  }
</style>

<form method="post" enctype="multipart/form-data">
  {% csrf_token %}

  <div class="modal-header">
    <h5 id="acompanhamento" class="modal-title">Acompanhamento</h5>    
    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>

  <div class="modal-body">

    <label for="data_hora">Data e Hora: </label> <input id="data_hora" class="form-control" type="datetime-local" name="data_hora" value="{{data_hora|date:'Y-m-d\TH:i'}}"><br>
    
    <label for="texto">Texto:</label><br>
    <textarea id="texto" name="texto" class="form-control" rows="5" required>{% if acompanhamento %}{{acompanhamento.texto}}{% endif %}</textarea>
    <br>

    <div class="form-group">
      <label for="parceiro">Nome:</label>

      <select id="parceiro" name="parceiro" title="Selecione o contato"
        data-width="100%"
        class="selectpicker" data-live-search="true" required>
        {% if not acompanhamento %}
          <option disabled selected value> -- selecione o contato -- </option>
        {% endif %}
        {% for parceiro in parceiros %}
          <option value="{{parceiro.id}}" {% if acompanhamento and acompanhamento.tipo_de_retorno == retorno.0 %}selected{% endif %} >{{parceiro.user}}</option>
        {% endfor %}
      </select>
    </div>

    <input type="submit" style="display:none;"/>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-secondary mb-1" data-dismiss="modal">Fechar</button>
    <button id="atualiza" type="button" class="btn btn-primary mb-1" data-dismiss="modal">Atualizar</button>
  </div>

</form>

<script>
  $('#atualiza').on('click', atualiza);
</script>