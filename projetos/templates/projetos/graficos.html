{% extends "base.html" %}
{% comment %}
    Desenvolvido para o Projeto Final de Engenharia
    Autor: Luciano Pereira Soares <lpsoares@insper.edu.br>
    Data: 22 de Setembro de 2020
{% endcomment %}

{% block head %}

  {% load static %}
  
  {% load l10n %}

  <script src="{% static 'js/w3.js' %}"></script>
  <script src="{% static 'js/Chart.min.js' %}"></script>
  <script src="{% static 'js/chartjs-plugin-datalabels.js' %}"></script>

  <script src="{% static 'js/Plugin.Errorbars.min.js' %}"></script>

  {% comment %} Para chamar os Tooltips {% endcomment %}
  <script>{% include "tooltip.js" %}</script>

{% endblock %}

{% block content %}

    <span class="titulo">Evolução por Notas/Conceitos</span>

    {% comment %} Seletor da edição da pesquisa {% endcomment %}
    
    {% comment %}
    {% with sem_edicao=True %}
    {% with com_cursos=True %}
        {% include "edicoes.html" %}
    {% endwith %}
    {% endwith %}
    {% endcomment %}

{% comment %}
<div id="container" style="width: 50%;">
  <canvas id="canvas"></canvas>
</div>

        <script>

var color = Chart.helpers.color;
  var barChartData = {
    labels: ["January", "February", "March", "April"],
    datasets: [{
      label: 'Dataset 1',
      //backgroundColor: '#d95f02',
      borderColor: '#d95f02',
      borderWidth: 1,
      data: [
        56,
        33,
        78,
        54
      ],
      errorBars: {
        'January': {plus: 15, minus: 34},
        'February': {plus: 15, minus: 3},
        'March': {plus: 35, minus: 14},
        'April': {plus: 45, minus: 4}
      }
    }, {
      label: 'Dataset 2',
      //backgroundColor: '#1b9e77',
      borderColor: '#1b9e77',
      borderWidth: 1,
      data: [
        100,
        77,
        33,
        45
      ],
      errorBars: {
        'January': {plus: 15, minus: 34},
        'February': {plus: 5, minus: 24},
        'March': {plus: 20, minus: 4},
        'April': {plus: 45, minus: 20}
      }
    }]
  };
    </script>
    {% endcomment %}


    <div class="atualizar">
    <div class="container">

        <div style="width:860px;"> 
            <canvas id="chart-medias"></canvas>
        </div>


    <script>
    var config_medias = {
        type: 'line',
        data: {
            labels: [
                {% for edicao in edicoes %}
                    "{{edicao}}",
                {% endfor %}
            ],
            datasets: [
                {% for media in medias %}
                    { 
                        data: [
                            {% for nota in media.media %}
                                {{nota|stringformat:".2f"|unlocalize}},
                            {% endfor %}
                        ],
                        label: "{{media.curso}}",
                        borderColor: "{{media.cor}}",
                        fill: false,
                        errorBars: {
                            '2020.1': [{plus: 0.71, minus: -0.73}, {plus: 0.91, minus: -0.52}],
                            '2020.2': [{plus: 0.82, minus: -0.61}, {plus: 0.52, minus: -0.82}],
                        },
                    },
                {% endfor %}
                 
            ]
        },
        options: {
            title: {
                display: true,
                text: 'Evolução nos semestres'
            }, 
            scales: {
                yAxes: [{
                    ticks: {
                        beginAtZero: true,
                        max: 10
                    }
                }]
            }

        }
    }
    


    function carrega_pagina() {  
      // Chart do média dos alunos
      var chart_medias = document.getElementById('chart-medias').getContext('2d');
      window.medias = new Chart(chart_medias, config_medias);



    var ctx = document.getElementById("canvas").getContext("2d");
    window.myBar = new Chart(ctx, {
      type: 'bar',
      data: barChartData,
      options: {
        responsive: true,
        legend: {
          position: 'top',
        },
        title: {
          display: true,
          text: 'Chart.js Error Bars Plugin'
        },
        plugins: {
          chartJsPluginErrorBars: {
            width: '60%',
            //color: 'darkgray'
          }
        }
      },
    });

    }

    window.onload = carrega_pagina
  
  </script>


    </div>
    </div>

    {% comment %}
    {% with sem_edicao=True %}
    {% with com_cursos=True %}
        {% include "edicoes_ajax.html" %}
    {% endwith %}
    {% endwith %} 
    {% endcomment %}

{% endblock %}