{% extends "base.html" %}
{% comment %}
  Desenvolvido para o Projeto Final de Engenharia
  Autor: Luciano Pereira Soares <lpsoares@insper.edu.br>
  Data: 15 de Maio de 2019
{% endcomment %}

{% block head %}
  {% comment %} <script src="https://www.w3schools.com/lib/w3.js"></script> {% endcomment %}
  <script src="{% static 'js/w3.js' %}"></script>
{% endblock %}

{% block content %}

  <span class="titulo">Organizações Parceiras</span>
  <br>

  {% if organizacoes_list %}
    <table id="OrganizacoesTable">
      <tr>
        <th onclick="w3.sortHTML('#OrganizacoesTable', '.item', 'td:nth-child(1)')" style="cursor:pointer" class="text-center">Organização</th>
        <th onclick="w3.sortHTML('#OrganizacoesTable', '.item', 'td:nth-child(2)')" style="cursor:pointer" class="text-center">Último<br>Contato</th>
        <th onclick="w3.sortHTML('#OrganizacoesTable', '.item', 'td:nth-child(3)')" style="cursor:pointer" class="text-center">Parceira<br>Desde</th>
        <th onclick="w3.sortHTML('#OrganizacoesTable', '.item', 'td:nth-child(4)')" style="cursor:pointer" class="text-center">Propostas<br>Enviadas</th>
        <th onclick="w3.sortHTML('#OrganizacoesTable', '.item', 'td:nth-child(5)')" style="cursor:pointer" class="text-center">Projetos<br>Fechados</th>
      </tr>
      {% for organizacao,fechados,desde,contato in organizacoes_list %} 
        <tr class="item">

        <td>
          <a href="{% url 'organizacao_completo' organizacao.id %}">
            {{organizacao.nome}}
          </a>
        </td>

        <td>
          {% if contato == '---------' %}
            ---------
          {% else %}
            {{contato.momento|date:"m/Y"}}
          {% endif %}
          </td>

          <td>
            {{desde}}
          </td>

          <td class="text-center">
            {{organizacao.proposta_set.count|stringformat:"03d"}}
          </td>

          <td class="text-center">
            {{fechados|stringformat:"03d"}}
          </td>

        </tr>
      {% endfor %}
    </table>
    <p>&nbsp;</p>
    <strong>Total de Organizações Parceiras:</strong> {{ total_organizacoes }}<br>
    <strong>Total de Propostas Submetidas:</strong> {{ total_submetidos }}<br>
    <strong>Total de Projetos Fechados:</strong> {{ total_fechados }}<br>
  {% else %}
    <p>Não existem organizações cadastradas.</p>
  {% endif %}

  <p>&nbsp;</p>

{% endblock %}