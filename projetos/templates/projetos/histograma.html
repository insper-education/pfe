{% extends "base.html" %}
{% comment %}
    Desenvolvido para o Projeto Final de Engenharia
    Autor: Luciano Pereira Soares <lpsoares@insper.edu.br>
    Data: 15 de Maio de 2019
{% endcomment %}

{% block head %}
  {% load static %}
  <link href="{% static 'css/horizBarChart.css' %}" media="all" rel="stylesheet" type="text/css" /> <!-- PARA HISTOGRAMA -->
  <script src="{% static 'js/jquery.horizBarChart.min.js' %}"></script>
  <script>
    $(document).ready(function(){
      $('.chart').horizBarChart({
        selector: '.bar',
        speed: 800
      });
    });
  </script>
{% endblock %}

{% block content %}
  <label for="filter">Edição:</label>
  <select id="filter" class="filter" data-tableId="projetos">
    <option value="2018.2">2018.2</option>
    <option value="2019.1">2019.1</option>
    <option value="2019.2">2019.2</option>
    <option value="2020.1" selected="selected">2020.1</option>
    <option value="2020.2">2020.2</option>
  </select>
  <br>

  {% if mylist %}
    <ul style="padding:0;" class="chart">
      <h3><li class="title" title="Procura dos Projetos"></li></h3>
      <li></li>
      <li></li>

      {% for proposta,opcoes in mylist %} 
          <a href="{% url 'proposta_completa' proposta.id %}"> 
            <li class="title" title="
            {% if not proposta.disponivel%}X{% endif %}
            {{ forloop.counter }}&ordm; :
            {{proposta.titulo}}
            ({{ proposta.organizacao.nome_empresa }})"></li>
          </a>
          <li class="past" title="">
            <span class="bar" data-number="{{opcoes}}"></span>
            <span class="number">{{opcoes}}</span>
          </li>
          <li></li>
      {% endfor %}
    </ul>
  
    {% comment %}
      <script type="text/javascript">
        $(".filter").change(function() {
          var filterValue = $(this).val();
          var row = $('.row'); 
          row.hide()
          var count_projects = 0
          var count_alunos = 0
          row.each(function(i, el) {
              if($(el).attr('data-type') == filterValue) {
                  $(el).show();
                  count_projects = count_projects + 1
                  count_alunos = count_alunos + $(el).find("TD").find("OL").children().length;
              }
          });
          if ("todas" == filterValue) {
            count_projects = {{ length }}
            count_alunos = {{ nalunos }}
            row.show();
          }
          document.getElementById("myCountProj").innerHTML = count_projects;
          document.getElementById("myCountAlun").innerHTML = count_alunos
        });
      </script>
    {% endcomment %}

  {% else %}
      <p>Não existem projetos disponíveis.</p>
    {% endif %}

{% endblock %}