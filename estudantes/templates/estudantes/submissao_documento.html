{% extends "base.html" %}
{% comment %}
    Desenvolvido para o Projeto Final de Engenharia
    Autor: Luciano Pereira Soares <lpsoares@insper.edu.br>
    Data: 3 de Novembro de 2023
{% endcomment %}

{% block head %}
  {% load static %}
  {% load date_extras %}
  <script>{% include "tooltip.js" %}</script>
  {% comment %} Para recarregar a página em caso de um botão back ou similar {% endcomment %}
  {% include "reload.html" %}
  <style>
    .lightgrey,
    .lightgrey:link,
    .lightgrey:visited,
    .lightgrey:hover,
    .lightgrey:active
      {color:lightgrey;}
  </style>
{% endblock %}


{% block content %}

    <br>
    <h4>Submissão de Documentos</h4>

    Projeto: {{projeto.get_titulo}}<br>
    Semestre: {{projeto.ano}}.{{projeto.semestre}}<br>
    <br>

    {% for item in itens %}
      {% with dias_ate=item.2.endDate|dif_dias_hoje dias=14 %} {% comment %} Eventos são mostrados duas semanas antes do prazo {% endcomment %}

      <div {% if dias_ate > dias and user.tipo_de_usuario == 1 %}style="display:none;"{% endif %}>
          <span {% if dias_ate > dias %}style="color:lightgrey;"{% endif %}>
          <b>{{item.0.nome}}</b> [prazo {{item.2.endDate}}]: </span><a 
            data-toggle="tooltip" data-html="true" animation="true" title="Adicionar documento"
            class="open-documento {% if dias_ate > dias %}lightgrey{% endif %}"
            {% comment %} data-url="{% url 'adiciona_documento' projeto.organizacao.id projeto.id %}"> {% endcomment %}
            data-url="{% url 'adiciona_documento' projeto.organizacao.id projeto.id item.0.id %}">

            {% if dias_ate > dias %}+{% else %}&#10133;{% endif %}	
          </a><br>
          <ul style="padding-left: 22px; width: fit-content;">
          {% for documento in item.1 %}
            <li style="list-style-type:'&#128463; ';">
            {% if documento.documento and documento.link %}
              {{documento.data}} - {{documento}}
              <a data-toggle="tooltip" data-html="true" animation="true" title="Entregue"
                 class="{% if dias_ate > dias %}lightgrey{% endif %}"
                 href="../..{{MEDIA_URL}}{{documento.documento}}" target="_blank" rel="noopener noreferrer">(documento)</a>
              <a data-toggle="tooltip" data-html="true" animation="true" title="Entregue" 
                 class="{% if dias_ate > dias %}lightgrey{% endif %}"
                 href="{{documento.link}}" target="_blank" rel="noopener noreferrer">(link)</a>
            {% else %}
              {% if documento.documento %}
                <a data-toggle="tooltip" data-html="true" animation="true" title="Entregue"
                   class="{% if dias_ate > dias %}lightgrey{% endif %}"
                   href="../..{{MEDIA_URL}}{{documento.documento}}" target="_blank" rel="noopener noreferrer">{{documento.data}} - {{documento}}</a>
              {% endif %}
              {% if documento.link %}
                <a data-toggle="tooltip" data-html="true" animation="true" title="Entregue"
                   class="{% if dias_ate > dias %}lightgrey{% endif %}"
                   href="{{documento.link}}" target="_blank" rel="noopener noreferrer">{{documento.data}} - {{documento}}</a>
              {% endif %}
            {% endif %}
            </li>
          {% empty %}
            Não entregue
          {% endfor %} 
          </ul><br>
        </div>
      {% endwith %}
    {% endfor %} 

    {% include "documento-modal.html" %}

{% endblock %}