{% extends "base.html" %}
{% comment %}
    Desenvolvido para o Projeto Final de Engenharia
    Autor: Luciano Pereira Soares <lpsoares@insper.edu.br>
    Data: 30 de Maio de 2020
{% endcomment %}

{% block head %}
  {% load static %}
  <script src="{% static 'js/w3.js' %}"></script>
  <script>{% include "tooltip.js" %}</script>
  <style>
    th {cursor:pointer; text-align: center;}
    td {padding: 1px 4px 1px 4px;}
    thead {background-color: #bee5eb;}
  </style>
{% endblock %}

{% block content %}
  
  <span class="titulo">{{titulo}}</span>

  {% include "edicoes.html" %}<br>

  <div class="atualizar">

    <form method="post" action="{% url 'envia_contas_senhas' %}" enctype="multipart/form-data">{% csrf_token %}
      <table id="EstudantesTable"><thead><tr>
            <th>&nbsp;<input type="checkbox" id="todos" checked>&nbsp;</th>
            <th onclick="w3.sortHTML('#EstudantesTable', '.item', 'td:nth-child(2)')">Estudante</th>
            <th onclick="w3.sortHTML('#EstudantesTable', '.item', 'td:nth-child(3)')">e-mail</th>
        </tr></thead>
        <tbody>
          {% for estudante in estudantes %} 
            <tr class="item">
              <td class="text-center"><input type="checkbox" id="estudante" name="estudante" value="{{estudante.id}}" checked></td>
              <td><a href="{% url 'estudante_detail' estudante.id %}">{{estudante.user.get_full_name}}</a></td>
              <td><a href="mailto:{{estudante.user.email}}">{{estudante.user.email}}</a></td>
            </tr>
          {% empty %}
            <p>Não existem estudantes nessa edição.</p>
          {% endfor %}
        </tbody>
      </table>

      <br><strong>Total de Estudantes:</strong> {{estudantes.count}}

      <br><br>
      <button class="btn btn-primary mb-1" type="submit">Enviar Contas e Senhas</button>

    </form>

  </div>

  <script>

    // Deixa todos os checkboxes marcados se o checkbox do header estiver marcado
    $("#todos").change(function () {
      $("input:checkbox").prop("checked", $(this).prop("checked"));
    });

    function carrega_pagina() {};
    function carrega_site(){
      carrega_pagina();
    };
    window.onload = carrega_site
  </script>
  
  {% include "edicoes_ajax.html" %}

{% endblock %}
