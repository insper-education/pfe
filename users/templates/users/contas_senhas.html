{% extends "base.html" %}
{% comment %}
    Desenvolvido para o Projeto Final de Engenharia
    Autor: Luciano Pereira Soares <lpsoares@insper.edu.br>
    Data: 30 de Maio de 2020
{% endcomment %}

{% block head %}

  {% load static %}

  <script src="{% static 'js/w3.js' %}"></script>

  {% comment %} Para chamar os Tooltips {% endcomment %}
  <script>{% include "tooltip.js" %}</script>

  <style>
    td {padding: 1px 4px 1px 4px;}
  </style>

{% endblock %}

{% block content %}
  
  <span class="titulo">Enviar Contas e Senhas para Estudantes</span>

  <label for="filter">Edição:</label>
  <select onchange="location = this.options[this.selectedIndex].value;">
    {% for loop in edicoes %}
      <option value="{{loop}}" {% if edicao == loop %}selected{% endif %}>{{loop}}</option>
    {% endfor %}
  </select>
  <br>

  {% if estudantes %}
    <form method="post" id="enviacontassenhas" enctype="multipart/form-data">
      {% csrf_token %}

      <table id="EstudantesTable"><thead>
        <tr style="background: #F0F0F0;">
            <th class="text-center">&nbsp;<input type="checkbox" id="todos" checked>&nbsp;</th>
            <th onclick="w3.sortHTML('#EstudantesTable', '.item', 'td:nth-child(1)')" style="cursor:pointer" class="text-center">Estudante</th>
            <th onclick="w3.sortHTML('#EstudantesTable', '.item', 'td:nth-child(2)')" style="cursor:pointer" class="text-center">e-mail</th>
        </tr></thead>
        <tbody>
        {% for estudante in estudantes %} 
        <tr class="item">
          <td class="text-center">
            <input type="checkbox" id="estudante" name="estudante" value="{{estudante.id}}" checked>
          </td>
          <td>
            <a href="{% url 'estudante_detail' estudante.id %}">
              {{estudante.user.get_full_name}}
            </a>
          </td>
          <td>
            <a href="mailto:{{estudante.user.email}}">
              {{estudante.user.email}}
            </a>
          </td>
        </tr>
        {% endfor %}
        </tbody>
      </table>

      <br><strong>Total de Estudantes:</strong> {{estudantes.count}}

      <br><br>
      <button class="btn btn-primary mb-1" type="submit">Enviar Contas e Senhas</button>

    </form>
    
  {% else %}
    <p>Não existem estudantes nesse critério.</p>
  {% endif %}

  <script>
    $("#todos").change(function () {
      $("input:checkbox").prop('checked', $(this).prop("checked"));
    });
  </script>

{% endblock %}
