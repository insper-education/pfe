{% extends "base.html" %}
{% comment %}
  Desenvolvido para o Projeto Final de Engenharia
  Autor: Luciano Pereira Soares <lpsoares@insper.edu.br>
  Data: 3 de Junho de 2021
  Atualizado: 28 de Fevereiro de 2026
{% endcomment %}

{% load static %}
{% load bleach %}
{% load propostas %}
{% load linguas %}

{% block head %}
  <link rel="stylesheet" href="{% static 'css/relatorios.css' %}">
{% endblock %}

{% block content %}

  <div class="relatorio-header">
    <h1>Propostas Dispon√≠veis</h1>
  </div>

  {% for proposta in propostas %} 

    <div class="relatorio-card">
      
      <div class="relatorio-card-header">
        <h3>{{ proposta.titulo }}</h3>
        <p class="subtitulo">{{ proposta.organizacao.nome }}</p>
      </div>

      <div class="relatorio-card-content">

        <div class="secao">
          <div class="secao-titulo">üìã {% lng "Descri√ß√£o da Proposta" "Proposal Description" %}</div>
          <div class="secao-conteudo">
            {% with completo=True %}
              {% include "proposta.html" %}
            {% endwith %}
          </div>
        </div>

        <div class="secao">
          <div class="secao-titulo">üè¢ {% lng "Organiza√ß√£o" "Organization" %}</div>
          <div class="secao-conteudo">
            {% with completo=True %}
              {% include "organizacao.html" %}
            {% endwith %}
          </div>
        </div>

        <div class="secao">
          <div class="secao-titulo">üë§ {% lng "Submetido por" "Submitted by" %}</div>
          <div class="secao-conteudo">
            <div class="info-box">
              <div class="info-label">{% lng "Respons√°vel" "Contact" %}:</div>
              <div class="info-valor">{{proposta.nome}}</div>
            </div>
          </div>
        </div>

        {% with c_t=proposta|contatos_tec %}
          {% if proposta.contatos_tecnicos or c_t %}
            <div class="secao">
              <div class="secao-titulo">üîß {% lng "Contatos T√©cnicos" "Technical Contacts" %}</div>
              <div class="secao-conteudo">
                <div class="contato-info">
                  {% if proposta.contatos_tecnicos %}
                    {{proposta.contatos_tecnicos|linebreaks|bleach_urlize|safe}}
                  {% endif %}
                  {% if c_t %}
                    {% for contato in c_t %}
                      <div class="contato-label">{{ contato }}</div>
                    {% endfor %}
                  {% endif %}
                </div>
              </div>
            </div>
          {% endif %}
        {% endwith %}

        {% with c_a=proposta|contatos_adm %}
          {% if proposta.contatos_administrativos or c_a %}
            <div class="secao">
              <div class="secao-titulo">üíº {% lng "Contatos Administrativos" "Administrative Contacts" %}</div>
              <div class="secao-conteudo">
                <div class="contato-info">
                  {% if proposta.contatos_administrativos %}
                    {{proposta.contatos_administrativos|linebreaks|bleach_urlize|safe}}
                  {% endif %}
                  {% if c_a %}
                    {% for contato in c_a %}
                      <div class="contato-label">{{ contato }}</div>
                    {% endfor %}
                  {% endif %}
                </div>
              </div>
            </div>
          {% endif %}
        {% endwith %}

        <div class="secao">
          <div class="secao-titulo">üí° {% lng "√Åreas de Interesse" "Areas of Interest" %}</div>
          <div class="secao-conteudo">
            {% with areas_de_interesse_selecionadas=proposta.areadeinteresse_set.all vencido=True com_borda=True %}
              {% include "areas.html" %}
            {% endwith %}
          </div>
        </div>

        <div class="secao">
          <div class="secao-titulo">‚≠ê {% lng "Recomenda√ß√µes" "Recommendations" %}</div>
          <div class="secao-conteudo">
            {% with editavel=False %}
              {% include "recomendadas.html" %}
            {% endwith %}
          </div>
        </div>

        <div class="secao">
          <div class="secao-titulo">üë• {% lng "Perfil de Estudantes" "Student Profile" %}</div>
          <div class="secao-conteudo">
            {% with editavel=False %}
              {% include "perfil_estudantes.html" %}
            {% endwith %}
          </div>
        </div>

      </div>

    </div>

  {% empty %}
    <div class="mensagem-vazia">
      ‚ö†Ô∏è N√£o existem propostas dispon√≠veis.
    </div>
  {% endfor %}

{% endblock %}