{% extends "base.html" %}
{% comment %}
  Desenvolvido para o Projeto Final de Engenharia
  Autor: Luciano Pereira Soares <lpsoares@insper.edu.br>
  Data: 18 de Junho de 2019
  Atualizado: 28 de Fevereiro de 2026
{% endcomment %}

{% load static %}

{% block head %}
  <link rel="stylesheet" href="{% static 'css/relatorios.css' %}">
{% endblock %}

{% block content %}

  <div class="relatorio-header">
    <h1>Estudantes</h1>
    <div class="periodo">Per√≠odo: {{configuracao.ano}}.{{configuracao.semestre}}</div>
  </div>

  {% for aluno in alunos %}
    <div class="relatorio-card">
      
      <div class="relatorio-card-header">
        <h3>{{aluno.user.get_full_name}}</h3>
        <p class="subtitulo">
          {{aluno.curso2}} {% if aluno.externo %}<span class="badge badge-purpura">[{{aluno.externo}}]</span>{% endif %}
        </p>
      </div>

      <div class="relatorio-card-content">
        
        <!-- CR -->
        <div class="secao">
          <div class="secao-titulo">üìö Coeficiente de Rendimento</div>
          <div class="secao-conteudo">
            <div class="info-box">
              <div class="info-grid">
                <div class="info-label">CR:</div>
                <div class="info-valor"><strong>{{aluno.cr}}</strong></div>
              </div>
            </div>
          </div>
        </div>

        <!-- √Åreas de Interesse -->
        {% with areas_de_interesse_selecionadas=aluno.user.areadeinteresse_set.all vencido=True %}
          {% if areas_de_interesse_selecionadas %}
          <div class="secao">
            <div class="secao-titulo">üí° √Åreas de Interesse</div>
            <div class="secao-conteudo">
              {% include "areas.html" %}
            </div>
          </div>
          {% endif %}
        {% endwith %}

        <!-- Projetos Selecionados -->
        <div class="secao">
          <div class="secao-titulo">üìå Projetos Selecionados</div>
          <div class="secao-conteudo">
            <div class="link-lista">
              {% for opcao in aluno.opcao_set.all %}
                {% if opcao.projeto.ano == opcao.aluno.ano and opcao.projeto.semestre == opcao.aluno.semestre %}
                  <div class="link-botao">
                    <span class="badge">{{opcao.prioridade}}</span>
                    <span>{{opcao.projeto.organizacao.nome}} ‚Äî {{opcao.projeto.get_titulo}}</span>
                  </div>
                {% endif %}            
              {% empty %}
                <p style="font-size: 0.9em; color: #999;">Nenhum projeto selecionado</p>
              {% endfor %}
            </div>
          </div>
        </div>

      </div>
    </div>
  {% empty %}
    <div class="mensagem-vazia">
      ‚ö†Ô∏è N√£o existem estudantes dispon√≠veis.
    </div>
  {% endfor %}

{% endblock %}