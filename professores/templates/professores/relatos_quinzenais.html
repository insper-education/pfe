{% extends "base.html" %}
{% comment %}
    Desenvolvido para o Projeto Final de Engenharia
    Autor: Luciano Pereira Soares <lpsoares@insper.edu.br>
    Data: 20 de Fevereiro de 2022
{% endcomment %}

{% block head %}
  {% load static %}

  {% comment %} Para chamar os Tooltips {% endcomment %}
  <script>{% include "tooltip.js" %}</script>
  
  {% comment %} Para recarregar a página em caso de um botão back ou similar {% endcomment %}
  {% include "reload.html" %}

  <link rel="stylesheet" href="{% static 'css/div_arrend.css' %}">
  <link rel="stylesheet" href="{% static 'css/outros.css' %}">

{% endblock %}

{% block content %}

  <span class="titulo">Relatos Quinzenais</span>

  {% comment %} Seletor da edição da pesquisa {% endcomment %}
  {% include "edicoes.html" %}
  <br>

  <div class="atualizar">

      {% for projeto in projetos %}
        {% if projeto.tem_relatos %}
          <div class="div_arredondado">
          
            <div class="tresp"><strong>Projeto:</strong> <a href="{% url 'projeto_completo' projeto.id %}">{{projeto.get_titulo}}</a>
            {% include "tipo_projeto.html" with com_tipo=False %}</div>
            <strong>Organização:</strong>
            {% if projeto.organizacao %}
              <a href="{% url 'organizacao_completo' projeto.organizacao.id %}">{{ projeto.organizacao.nome }}</a>
            {% else %}
              ORGANIZAÇAO NÃO DEFINIDA
            {% endif %}
            <br>
            {% if edicao == "todas" %}
              <strong>Semestre:</strong> {{projeto.ano}}.{{projeto.semestre}}<br>
            {% endif %}
            {% if administracao %}<strong>Orientador:</strong>
              {% if projeto.orientador %}
                <a href="{% url 'professor_detail' projeto.orientador.id %}">{{projeto.orientador}}</a>
              {% else %}
                ORIENTADOR NÃO DEFINIDO
              {% endif %}
            {% endif %}

            <div style="margin-top:8px;"><strong>Relatos (prazos para estudantes):</strong></div>

            {% with alocacoes=projeto.alocacao_set.all %}
              {% include "relatos.html" %}
            {% endwith %}

          </div>
        {% endif %}
      {% empty %}
       Sem alocações de projetos esse semestre.
      {% endfor %}

    <script>
      function carrega_pagina(){};
      window.onload = carrega_pagina
    </script>

  </div> 

  <script>

    function carrega_pagina() {
    };

    function carrega_site() {
      var filterEdicao = localStorage.getItem("filterEdicao");
      if (filterEdicao !== null && $("#filterEdicao option[value='"+filterEdicao+"']").length > 0 ) {
        $('#filterEdicao').val(filterEdicao).trigger('change');
      }
      carrega_pagina();
    };

    window.onload = carrega_site
  </script>

  {% include "edicoes_ajax.html" %}

{% endblock %}