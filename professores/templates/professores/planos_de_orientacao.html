{% extends "base.html" %}
{% comment %}
    Desenvolvido para o Projeto Final de Engenharia
    Autor: Luciano Pereira Soares <lpsoares@insper.edu.br>
    Data: 18 de Agosto de 2023
{% endcomment %}

{% block head %}
  {% load static %}
  {% load certificado_banca %}
  {% load tipo_documento %}

  <script>{% include "tooltip.js" %}</script>

  {% comment %} Para recarregar a página em caso de um botão back ou similar {% endcomment %}
  {% include "reload.html" %}
  
  <link rel="stylesheet" href="{% static 'css/tab_arrend.css' %}">
  <link rel="stylesheet" href="{% static 'css/short_full.css' %}">

  <style>
    .arredondado {width: auto;}
  </style>

{% endblock %}

{% block content %}

    <span class="titulo">Planos de Orientação</span>

    <table class="table table-borderless table-sm arredondado">
      {% for projeto in projetos %}
        {% ifchanged projeto.periodo %}
          {% if not forloop.first %}</tbody>{% endif %}
          <thead><tr><th style="margin-top: 1em; font-weight: bold; font-size: 1.2rem;">{{ projeto.periodo }}</th></tr></thead>
          <tbody>
        {% endifchanged %}
        <tr><td>
        {% for documento in projeto.get_planos_de_orientacao %}
          <a {% if projeto.periodo == "Anteriores" %}style="color:grey"{% else %}style="color:green"{% endif %}
           data-toggle="tooltip" data-html="true" animation="true" title="Entregue"
           {% if projeto.periodo == "Anteriores" %}
            {% with documento=projeto.documento_set.all|tipo_documento:"Plano de Orientação" %}
             href="../..{{MEDIA_URL}}{{documento.documento}}" target="_blank" rel="noopener noreferrer"
            {% endwith %}
           {% else %}
            class="open-documento"
            data-url="{% url 'adiciona_documento' projeto.organizacao.id projeto.id "Plano de Orientação" documento.id %}" 
           {% endif %}
           ><b>&#128463;
        {% empty %}
          <a {% if projeto.periodo == "Anteriores" %}style="color:grey"{% else %}style="color:red"{% endif %}
           data-toggle="tooltip" data-html="true" animation="true" title="Não entregue"
           {% if projeto.periodo != "Anteriores" %}
            class="open-documento"
            data-url="{% url 'adiciona_documento' projeto.organizacao.id projeto.id "Plano de Orientação" %}"
           {% endif %}
            ><b>&#128460;
        {% endfor %}</b>
         {{projeto.ano}}.{{projeto.semestre}} - {{projeto.organizacao.nome}}, {{projeto.get_titulo}}
        </a>
      </td></tr>
    {% empty %}
      Orientações não encontradas
    {% endfor %}
  </tbody></table>

  {% include "documento-modal.html" %}

{% endblock %}