{% comment %}
    Desenvolvido para o Projeto Final de Engenharia
    Autor: Luciano Pereira Soares <lpsoares@insper.edu.br>
    Data: 4 de Fevereiro de 2021
{% endcomment %}


{% comment %} Usar só esse, não o .js {% endcomment %} 

{% if edicoes %}
  <script>

     function recarregar_pagina() {
      $("#spinner").css("visibility", "visible");
      {% if not sem_edicao %}
        var edicao = $("#filterEdicao option:selected").attr("value");
      {% endif %}
      {% if com_cursos %}
        var curso = $("#filterCurso option:selected").attr("value");
      {% endif %}
      {% if com_individual %}
        var individual = $("#filterCurso option:selected").attr("value");
      {% endif %}
      $.ajax({
          type: "POST",
          //url: "Normalmente a mesma página",
          data: {
              {% if not sem_edicao %}
                edicao: edicao,
              {% endif %}
              {% if com_cursos %}
                curso: curso,
              {% endif %}
              'csrfmiddlewaretoken': '{{ csrf_token }}',
          },
          success: function(response){
              $(".atualizar").replaceWith($(".atualizar",response));
              {% include "tooltips.js" %}
              {% if tabela %}
                {% include "tabelas_scripts.js" %}
              {% endif %}
              {% if graficos %}
                carrega_graficos();
              {% endif %}
              carrega_pagina();
              $("#spinner").css("visibility", "hidden");
          },
          error: function(response) {
              console.log('error')
          }
      });
    }

    $(".filter").change(recarregar_pagina);

    // pequeno tempo para select voltar a funcionar
    function recarregar() {
        setTimeout(function () {
                recarregar_pagina();
        }, 10);
    }
    recarregar();

  </script>

{% endif %}