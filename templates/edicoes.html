{% comment %}
    Desenvolvido para o Projeto Final de Engenharia
    Autor: Luciano Pereira Soares <lpsoares@insper.edu.br>
    Data: 6 de Dezembro de 2020
{% endcomment %}

{% comment %} Seletor da edição da pesquisa {% endcomment %}
{% if edicoes %}
<style>
.separador {
  margin-right: 16px;
}

@media only screen and (max-width: 520px) {
  .to_hide {
    font-size: 0.7rem;
    min-width:22%;
    max-width:18%;
    width:2rem;
  }
  .to_label {
    padding: 4px !important;
  }
  .separador {
    margin-right: 6px;
    width: 100vw;
  }
  #filterEdicao {
    padding-right: 22px;
    padding-left: 2px;
  }
}
</style>

  <div class="row align-items-start mb-2" style="display: inline-block; margin-right: 3px;">
    <div class="ml-3">
      <div class="input-group input-group-sm">
        {% if not sem_edicao %}
          <div class="input-group-prepend">
            <label class="to_label input-group-text" for="filterEdicao" onClick="recarregar_pagina()"><span class="to_hide">Edição</span></label>
          </div>
          <select class="to_hide filter custom-select w-auto" id="filterEdicao" name="edicao">
            {% comment %} Se não quiser que aparece a opção todas crie uma variavel n_todas com True {% endcomment %}
            {% if not n_todas %}
              <option value="todas">todas</option>
            {% endif %}
            {% for edicao in edicoes %}
                <option value="{{edicao}}" 
                    {% if selecionada %}
                      {% if selecionada == edicao %}selected{% endif %}
                    {% else %}
                      {% if forloop.last %}selected{% endif %}
                    {% endif %}
                >{{edicao}}</option>
            {% endfor %}
          </select>
        {% endif %}
        {% if com_cursos %}
          {% if not sem_edicao %}
          <div class="separador input-group-addon"></div>
          {% endif %}
          <div class="input-group-prepend">
            <label class="to_label input-group-text" for="filterCurso" onClick="recarregar_pagina()"><span class="to_hide">Curso</span></label>
          </div>
          <select class="filter custom-select w-auto" id="filterCurso" name="curso">
              <option value="T">todos</option>
              {% if cursos %}
                {% for c in cursos %}
                  {% if c.curso_do_insper %}
                    <option value="{{c.sigla_curta}}" {% if curso == c.sigla_curta %}selected{% endif %}>{{c.nome}}</option>
                  {% endif %}
                {% endfor %}
                {% for c in cursos %}
                  {% if not c.curso_do_insper %}
                    <option class="text-info" value="{{c.sigla_curta}}" {% if curso == c.sigla_curta %}selected{% endif %}>{{c.nome}}</option>
                  {% endif %}
                {% endfor %}
                {% comment %} <optgroup label="Comitê PFE">
                  <option value="xxx">XXXX</option>
                </optgroup> {% endcomment %}
              {% else %}
                <option value="C" {% if curso == "computação" %}selected{% endif %}>computação</option>
                <option value="X" {% if curso == "mecatrônica" %}selected{% endif %}>mecatrônica</option>
                <option value="M" {% if curso == "mecânica" %}selected{% endif %}>mecânica</option>
                {% comment %} <option value="B" {% if curso == "ciencia" %}selected{% endif %}>c. computação</option> {% endcomment %}
              {% endif %}
          </select>
        {% endif %}

        {% if com_objetivos %}
          
          <span class="input-group-addon">&nbsp;&nbsp;&nbsp;&nbsp;</span>
          
          <div class="input-group-prepend">
            <label class="input-group-text" for="filterObjetivo" onClick="recarregar_pagina()"><span class="to_hide">Objetivo de Aprendizagem</span></label>
          </div>
          <select class="filter custom-select w-auto" id="filterObjetivo" name="objetivo">

                {% for objetivo in objetivos %}
                  <option value="{{objetivo.id}}" 
                  {% if objetivo.id == obj_selecionado %}selected{% endif %}>{{objetivo}} - {{objetivo.data_inicial}}</option>
                {% endfor %}

          </select>
        {% endif %}

        {% if ind_grup %}

          <span class="input-group-addon">&nbsp;&nbsp;&nbsp;&nbsp;</span>

          <div class="form-check mb-2 mr-sm-2">
            <input class="filter form-check-input" type="checkbox" id="individuais" checked >
            <label class="form-check-label" for="individuais">Individuais</label>
          </div>

          <div class="form-check mb-2 mr-sm-2">
            <input class="filter form-check-input" type="checkbox" id="grupo" checked >
            <label class="form-check-label" for="grupo">Grupo</label>
          </div>

        {% endif %}

        {% if so_finais %}
          <span class="input-group-addon">&nbsp;&nbsp;&nbsp;&nbsp;</span>
          <div class="form-check mb-2 mr-sm-2">
            <input class="filter form-check-input" type="checkbox" id="so_finais" checked >
            <label class="form-check-label" for="so_finais">Só avaliações finais</label>
          </div>
        {% endif %}

        {% if avancados %}
          <span class="input-group-addon">&nbsp;&nbsp;&nbsp;&nbsp;</span>
          <div class="form-check mb-2 mr-sm-2">
            <input class="filter form-check-input" type="checkbox" id="avancados" checked >
            <label class="form-check-label" for="avancados">Avancados</label>
          </div>
        {% endif %}

        <div id="spinner" class="ml-2 input-group-append" style="visibility: hidden">
          <div class="spinner-border text-secondary ml-auto" style="width: 1.8rem; height: 1.8rem;" role="status" aria-hidden="true">
            <span class="sr-only input-group-text">Carregando...</span>
          </div>
        </div>
        
      </div>

    </div>
    <div id="lateral">
    </div>
  </div>

  {% comment %} Salva a última edição selecionada {% endcomment %}
  <script>
    window.onbeforeunload = function() {
      localStorage.setItem("filterEdicao", $('#filterEdicao').val());
    }
  </script>

{% endif %}
