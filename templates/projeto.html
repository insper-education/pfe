{% comment %}
  Desenvolvido para o Projeto Final de Engenharia
  Autor: Luciano Pereira Soares <lpsoares@insper.edu.br>
  Data: 10 de Novembro de 2020
{% endcomment %}

{% load static %}
{% load bleach %}
{% load get_field %}
{% load addhttp %}
{% load linguas %}

<span style="display: block; margin-bottom: 14px">
  {% if projeto.titulo_final and projeto.titulo_final != projeto.proposta.titulo %}
    <h4>[{{projeto.organizacao}}]
       {{projeto.titulo_final}} ({{projeto.ano}}.{{projeto.semestre}})</h4>
    <small>&nbsp;&nbsp;&nbsp;&nbsp;<b>
      {% lng "Título original da proposta" "Original title of the proposal" %}
    </b>: {{projeto.proposta.titulo}}</small><br>
  {% else %}
    <h4>[{{projeto.organizacao}}] {{projeto.get_titulo}} ({{projeto.ano}}.{{projeto.semestre}})</h4>
  {% endif %}
</span>

{% include "projetos/includes/bloco_titulo_resumo_pchave.html" with projeto=projeto %}

{% include "projetos/includes/bloco_site_pasta_proj.html" with projeto=projeto %}

<div>
  <b>{% lng "Descrição da proposta (escrito pela organização parceira):" "Proposal description (written by the partner organization):" %}</b>
  {{projeto.proposta.descricao|linebreaks|bleach_urlize|safe}}<br>

  {% if projeto.proposta.expectativas %}
    <b>{% lng "Expectativas de resultados/entregas:" "Expectations of results/deliverables:" %}</b>
    {{projeto.proposta.expectativas|linebreaks|bleach_urlize|safe}}<br>
  {% endif %}

  {% if projeto.proposta.recursos %}
    <b>{% lng "Recursos a serem disponibilizados aos Estudantes:" "Resources to be made available to Students:" %}</b>
    {{ projeto.proposta.recursos|linebreaks|bleach_urlize|safe}}
    {% if projeto.proposta.observacoes %}
      <b>{% lng "Outras observações:" "Other observations:" %}</b>
      {{ projeto.proposta.observacoes|linebreaks|bleach_urlize|safe}}<br>
    {% endif %}
  {% endif %}
</div>

<div>
  {% if projeto.organizacao.logotipo %}
    <img id="logotipo" class="logotipo flutua_dir" src="{{ projeto.organizacao.logotipo.url }}" alt="{{ projeto.organizacao.sigla }}">
  {% endif %}

  <h5>
    {% lng "Organização:" "Organization:" %}
    {{ projeto.organizacao.nome }}
  </h5>
  <b>{% lng "endereço:" "address:" %}</b>
  {{ projeto.organizacao.endereco|linebreaks }}<br>
  <b>website:</b> <a href="{{ projeto.organizacao.website|add_http }}">{{ projeto.organizacao.website }}</a><br>
</div>

<div>
  {% if projeto.orientador %}
    <h6 style="margin-bottom: 4px;">{% lng_g projeto.orientador.user.genero "Orientador" "Orientadora" "Advisor" %}</h6>
    <ul>
      <li><a href="mailto:{{projeto.orientador.user.email}}">{{ projeto.orientador.user.get_full_name}}</a>
        <span class="texto-longo emails"><a class="email" href="mailto:{{projeto.orientador.user.email}}">&lt;{{projeto.orientador.user.email}}&gt;</a></span>
        <span class="texto-curto emails"><a class="email" href="mailto:{{projeto.orientador.user.email}}"><i class="far fa-envelope"></i></a></span>
      </li>
    </ul>
  {% endif %}

  <h6 style="margin-bottom: 4px;">{% lng "Estudantes do Grupo" "Group Students" %}</h6>
  <ul>
    {% for membro in projeto.alocacao_set.all %}
      <li>
        <a href="mailto:{{membro.aluno.user.email}}">{{membro.aluno.user.get_full_name}}</a>
        <span class="texto-longo curso unselectable">[{{ membro.aluno.curso2 }}]</span>
        <span class="texto-curto curso unselectable">[{{ membro.aluno.curso2.sigla_curta }}]</span>
        {% if membro.aluno.externo %}<span style="color:red">[{{membro.aluno.externo}}]</span>{% endif %}
        <span class="texto-longo emails"><a class="email" href="mailto:{{membro.aluno.user.email}}">&lt;{{membro.aluno.user.email}}&gt;</a></span>
        <span class="texto-curto emails"><a class="email" href="mailto:{{membro.aluno.user.email}}"><i class="far fa-envelope"></i></a></span>
      </a></li>
    {% endfor %}
  </ul>


  {% with associados=projeto.associado_set.all %}
    {% if associados %}
      <h6 style="margin-bottom: 4px;">{% lng "Participante associado" "Associated Participant" %}</h6>
      <ul>
        {% for associado in associados %}
          <li>
            <a href="mailto:{{associado.estudante.user.email}}">{{ associado.estudante.user.get_full_name}}</a>
            <span class="texto-longo curso unselectable">[{{ associado.estudante.curso2 }}]</span>
            <span class="texto-curto curso unselectable">[{{ associado.estudante.curso2.sigla_curta }}]</span>
            {% if associado.estudante.externo %}<span style="color:red">[{{associado.estudante.externo}}]</span>{% endif %}
            <span class="texto-longo emails"><a class="email" href="mailto:{{associado.estudante.user.email}}">&lt;{{associado.estudante.user.email}}&gt;</a></span>
            <span class="texto-curto emails"><a class="email" href="mailto:{{associado.estudante.user.email}}"><i class="far fa-envelope"></i></a></span>
          </li>
        {% endfor %}
      </ul>
    {% endif %}
  {% endwith %}
  
</div>


<script>
  $(document).ready(function(){	
    // Ajusta a altura de todas as textareas
    $("textarea").each(function(){
      if($(this).is(":visible")) {
        $(this).css("height", this.scrollHeight + "px");
      }
    });
  });
</script>