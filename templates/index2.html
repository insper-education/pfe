{% extends "base.html" %}
{% comment %}
  Desenvolvido para o Projeto Final de Engenharia
  Autor: Luciano Pereira Soares <lpsoares@insper.edu.br>
  Data: 3 de Dezembro de 2019
{% endcomment %}

{% block head %}
  {% load static %}
  <link rel="stylesheet" href="{% static 'css/indexes.css' %}">
  {% include "reload.html" %}

  <style>
    {% comment %} body {
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      font-family: 'Arial', sans-serif;
    }

    .container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      padding: 20px;
    }

    .card-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
    }

    .card {
      border: none;
      border-radius: 15px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      transition: transform 0.3s, box-shadow 0.3s;
      overflow: hidden;
      background: white;
      position: relative;
      z-index: 1;
    }

    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
      z-index: -1;
      transition: transform 0.5s;
      transform: scale(1.5);
      border-radius: 15px;
    }

    .card:hover::before {
      transform: scale(1);
    }

    .card:hover {
      transform: translateY(-10px) scale(1.05);
      box-shadow: 0 12px 24px rgba(0, 0, 0, 0.2);
    }

    .card-body {
      padding: 20px;
      text-align: center;
      background: white;
      border-radius: 0 0 15px 15px;
    }

    .card-title {
      font-size: 1.5rem;
      margin-bottom: 0.5rem;
      color: #333;
      font-weight: bold;
    }

    .card-text {
      font-size: 1rem;
      color: #666;
      margin-bottom: 1rem;
    }

    .link_direto {
      text-decoration: none;
      color: inherit;
      display: inline-block;
      padding: 10px 20px;
      background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
      color: white;
      border-radius: 25px;
      transition: background 0.3s, transform 0.3s;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }

    .link_direto:hover {
      background: linear-gradient(135deg, #2575fc 0%, #6a11cb 100%);
      transform: translateY(-5px);
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
    }

    .extra-space {
      margin-top: 20px;
    } {% endcomment %}

    
  </style>

  
{% endblock %}

{% block content %}
<div class="container mt-5">
  <div class="card-container">
    <div class="card">
      <a  class="link_direto" href="{% url 'calendario' %}">
        <div class="card-body">
          <h5 class="card-title">Calendário Geral</h5>
        </div>
      </a>
    </div>

    {% if perms.estudantes %}
      <div class="card extra-space">
        <div class="card-body" onclick="loadContent(this, '{% url 'estudantes' %}')">
          <h5 class="card-title">Área dos Estudantes</h5>
        </div>
        <div class="card-content"></div>
      </div>
    {% endif %}
    {% if perms.projetos.add_proposta %}
      <div class="card">
        <div class="card-body" onclick="loadContent(this, '{% url 'organizacoes' %}')">
          <h5 class="card-title">Área dos Parceiros</h5>
        </div>
        <div class="card-content"></div>
      </div>
    {% endif %}
    {% if perms.users.change_professor %}
      <div class="card">
        <div class="card-body" onclick="loadContent(this, '{% url 'professores' %}')">
          <h5 class="card-title">Área dos Professores</h5>
        </div>
        <div class="card-content"></div>
      </div>
      <div class="card extra-space">
        <div class="card-body" onclick="loadContent(this, '{% url 'academica' %}')">
          <h5 class="card-title">Área Acadêmica</h5>
        </div>
        <div class="card-content"></div>
      </div>
      <div class="card">
        <div class="card-body" onclick="loadContent(this, '{% url 'operacional' %}')">
          <h5 class="card-title">Área Operacional</h5>
        </div>
        <div class="card-content"></div>
      </div>
      {% if perms.users.view_administrador %}
        <div class="card">
          <div class="card-body" onclick="loadContent(this, '{% url 'administracao' %}')">
            <h5 class="card-title">Área Administrativa</h5>
          </div>
          <div class="card-content"></div>
        </div>
      {% endif %}
    {% endif %}
    {% if perms.projetos.view_proposta or perms.projetos.view_projeto %}
      {% if perms.projetos.view_proposta %}
        <div class="card extra-space">
          <div class="card-body" onclick="loadContent(this, '{% url 'propostas' %}')">
            <h5 class="card-title">Propostas</h5>
          </div>
          <div class="card-content"></div>
        </div>
      {% endif %}
      {% if perms.projetos.view_projeto %}
        <div class="card">
          <div class="card-body" onclick="loadContent(this, '{% url 'projetos' %}')">
            <h5 class="card-title">Projetos</h5>
          </div>
          <div class="card-content"></div>
        </div>
      {% endif %}
    {% endif %}

    <div class="card extra-space">
      <div class="card-body" onclick="loadContent(this, '{% url 'documentos' %}')">
        <h5 class="card-title">Documentações</h5>
      </div>
      <div class="card-content"></div>
    </div>

  </div>
</div>

<script>
  function loadContent(element, url) {
    const cardContent = element.nextElementSibling;
    const dynamicUrl = new URL(url, window.location.origin);
    dynamicUrl.searchParams.set('dynamic', 'true');
  
    if (cardContent.style.display === "none" || cardContent.style.display === "") {
      fetch(dynamicUrl)
        .then(response => {
          if (!response.ok) {
            throw new Error('Network response was not ok');
          }
          return response.text();
        })
        .then(html => {
          cardContent.innerHTML = html;
          $(cardContent).slideDown("fast");
  
          // Extract and execute scripts
          const scripts = cardContent.querySelectorAll('script');
          scripts.forEach(script => {
            const newScript = document.createElement('script');
            if (script.src) {
              newScript.src = script.src;
            } else {
              newScript.textContent = script.textContent;
            }
            document.body.appendChild(newScript);
            document.body.removeChild(newScript);
          });
        })
        .catch(error => {
          console.error('Error loading content:', error);
          cardContent.innerHTML = '<div class="alert alert-danger">Error loading content</div>';
          $(cardContent).slideDown("fast");
        });
    } else {
      $(cardContent).slideUp("fast", () => {
        cardContent.innerHTML = "";
      });
    }
  }
</script>

{% endblock %}